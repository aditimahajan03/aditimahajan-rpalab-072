(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],{"677":function(e,t,n){e.exports=n(894)()},"894":function(e,t,n){"use strict";var r=n(895);function i(){}function s(){}s.resetWarningCache=i;e.exports=function(){function e(e,t,n,i,s,o){if(o!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");u.name="Invariant Violation";throw u}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};n.PropTypes=n;return n}},"895":function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"1402":function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return a});var r=n(0),i=n(7),s=n(5),o=n(15),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{identityDataSource:o.x});return t})(i.n);t.default=u;var a=Object(s.s)("GraphTokenProvider",u)},"1403":function(e,t,n){"use strict";n.r(t);n.d(t,"GraphUrlDataSource",function(){return u});n.d(t,"resourceKey",function(){return a});var r=n(3),i=n(5),s=n(4),o=n(123),u=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return!Object(s.isFeatureEnabled)(s.UseNewShareDialog)||Object(o.e)()&&!Object(s.isFeatureEnabled)(s.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta"};return e})(),a=new r.t({name:"GraphUrlDataSource",factory:new i.i(u)})},"1448":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(5),i=n(1402),s=n(1403),o=n(540),u=Object(r.s)("GraphDataRequestor",o.e,{sessionManagementProvider:i.resourceKey,urlDataSource:s.resourceKey});o.e},"3246":function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return o});var r=n(5),i=n(2656);n.d(t,"CheckUserAccessDataSource",function(){return i.e});var s=n(395),o=Object(r.s)("CheckUserAccessDataSource",i.e,{vroomDataRequestor:s.e})},"3454":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(26),s=n(5),o=n(7),u=n(569),a=n(1279),f=n(1449),l=n(2404),c=n(1206),h=n(1448),p=n(36),d=n(677),v=n(1481),m=n(1007),g=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.getChildContext=function(){return{resize:this.props.resizeCallback,onDismiss:this.props.dismissCallback,sharingStore:this.props.sharingStore,platformDetection:this.props.platformDetection,shareClickTime:this.props.shareClickTime}};t.prototype.render=function(){var e=this.props.mentionProps;return i.createElement(m.e,{isClickableOutsideFocusTrap:!0},i.createElement(v.e,Object(r.__assign)({},e)))};t.childContextTypes={resize:d.func.isRequired,onDismiss:d.func.isRequired,sharingStore:d.object.isRequired,platformDetection:d.object.isRequired,shareClickTime:d.number};return t})(i.Component),y=n(864);n.d(t,"resourceKey",function(){return w});var b=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onCompleteGrantAccessCallback=function(e){r._statusCallback&&(e?r._statusCallback("share_grantAccessCompleted"):r._statusCallback())};return r}t.prototype.init=function(e,t){this._resources=e;this._item=t;this._platformDetection=this._resources.consume(p.e);var n=new c.e({},{dataRequestor:this._resources.consume(h.e)});this._store=new l.e({itemName:this._item.displayName,sharingService:n,itemId:this._item.id,itemUrl:this._item.openUrl,defaultRecipients:[],accessChecked:!0,mode:u.e.atMention},void 0);this._store.fetchSharingInformation(!0)};t.prototype.waitUntilReady=function(e){void 0===e&&(e=0);return Object(r.__awaiter)(this,void 0,void 0,function(){var t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return e&&e>0?[4,new Promise(function(n){return t.async.setTimeout(n,e)})]:[3,2];case 1:n.sent();n.label=2;case 2:return this._store.getSharingInformation()?[2,"ready"]:e>5e3?[2,"timeout"]:[4,this.waitUntilReady(2*e+100)];case 3:return[2,n.sent()]}})})};t.prototype.setDismissCallback=function(e){this._dismissCallback=e};t.prototype.setResizeCallback=function(e){this._resizeCallback=e};t.prototype.setStatusCallback=function(e){this._statusCallback=e};t.prototype.setGrantees=function(e){this._recipients=this._prepareRecipientPeopleFromGrantees(e)};t.prototype.renderGrantAccess=function(){return i.createElement(g,{mentionProps:this._getMentionProps(),dismissCallback:this._dismissCallback,statusCallback:this._statusCallback,resizeCallback:this._resizeCallback,sharingStore:this._store,platformDetection:this._platformDetection,shareClickTime:Date.now()})};t.prototype.getPeoplePickerQueryParams=function(e){return{allowEmailAddresses:!0,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:y.e.user,useGraph:!0}};t.prototype.isShareAndNotifyDialogEnabled=function(e){return!0};t.prototype._getMentionProps=function(){return{clientId:a.e.odc,scenarioId:"Item Feed Grant Access",currentSettings:{allowEditing:!0,audience:f.e.anyone,expiration:new Date,hasPassword:!1,password:"",isEdit:!0,sharingLinkKind:1,specificPeople:[],updatePassword:!1},sharingInformation:this._store.getSharingInformation(),recipients:this._recipients,onComplete:this._onCompleteGrantAccessCallback}};t.prototype._prepareRecipientPeopleFromGrantees=function(e){for(var t,n,r,i,s,o=[],u=0;u<e.length;u++){var a={name:(null===(t=e[u].user)||void 0===t?void 0:t.displayName)||(null===(n=e[u].user)||void 0===n?void 0:n.email),email:null===(r=e[u].user)||void 0===r?void 0:r.email,userId:(null===(i=e[u].user)||void 0===i?void 0:i.id)||(null===(s=e[u].user)||void 0===s?void 0:s.email),isResolved:!0};o.push(a)}return o};return t})(o.n),w=(t.default=b,Object(s.s)("ItemActivityFeedSharingHelper",b))}}]);